@model eidss.model.Schema.LabSampleReceive
@{
    ViewBag.Title = Translator.GetMessageString("titleAccessionInTitle");
    Layout = "~/Views/Shared/_DetailsLayout.cshtml";
}
@using eidss.webclient.Utils;
@using eidss.webclient.Areas.Sample;

<script src="../../Scripts/Sample/CommonScript.js" type="text/javascript"></script>
<script src="../../Scripts/ASSession/Script.js" type="text/javascript"></script>
<script src="../../Scripts/Organization/CommonScript.js" type="text/javascript"></script>
<script src="../../Scripts/Employee/CommonScript.js" type="text/javascript"></script>

<script type="text/javascript">
    //var bFirst = true;
    $(window).load(function () {
        if ($("#ShowCasePicker").length > 0) {
            if ($("#ShowCasePicker")[0].value == 'true') {
                ShowASSessionPicker();
            }
        }

        if ($("#ErrorMessage").val()) {
            $("#ShowTestResultReportClick").val('');
        }
        if ($("#ShowAccessionInReportClick") && $("#ShowAccessionInReportClick").val() == '1') {
            var lang = GetSiteLanguage();
            var url = "/" + lang + "/LabSample/AccessionInReport";
            ShowAccessionInReport(url);
        }

        var caseId = $("#idfCase").val();
        if (caseId == '' || caseId == 0) {
            $("#bMainPanel_AccessionInReport").attr('disabled', 'disabled');
        }
    });           
</script>

@using (Html.BeginForm())
{
    <input name="idforselect" id="idforselect" type="hidden" />
    <input id='SaveAndExitClick' name='SaveAndExitClick' type='hidden' value='@ViewData["SaveAndExitClick"]' />   
    <input id='ShowCasePicker' name='ShowCasePicker' type='hidden' value='@ViewData["ShowCasePicker"]' />   
    <input id='OnlyReload' name='OnlyReload' type='hidden' value='@ViewData["OnlyReload"]' />
    <input type="hidden" id="ShowAccessionInReportClick" name='ShowAccessionInReportClick' value="@ViewBag.ShowAccessionInReportClick" />    
    <input id='idfCase' name='idfCase' type='hidden' value='@Model.idfMonitoringSession' />
    
    @Html.IdentificationAndHeartbeat("ID", Model.ID)

    <div class="detailsWindow largeDetailsWindow">
        <div class="detailsTitle">
			<table class="detailsTitleContent">
				<tr>						
					<td class="titleImage">
                        <img src="../../Content/Images/Sample-Accession-(large).png" alt="" />
                    </td>
                    <td class="titleText">
                        @Translator.GetMessageString("titleAccessionInTitle")
                    </td>
                    <td class="titleText titleFormCode">
                        L05
                    </td>
				</tr>
			</table>
		</div>   
        <table>           
            <tr>
                <td class="small">       
                    @Html.LabelFor(m => m.strMonitoringSessionID)
                </td>
                <td class="xlarge noIndent">
                    <table>
                        <tr>
                            <td>
                                @Html.BvEditbox(Model, "strMonitoringSessionID")
                            </td>
                            <td class="selectButton">                                
                                <button onclick="ShowASSessionPicker();" type="button" class="magnifierButton" >
                                    <img src="@Url.Content(VirtualPathUtility.ToAbsolute("~/Content/Images/ActionsPanelButtons/Search.png"))" alt="Select" />
                                </button>
                            </td>
                            <td class="selectButton">
                                @if (Model.idfMonitoringSession.HasValue)
                                {
                                    <input class="coloredButton" type="button" onclick="OpenPopup('../ASSession/Details?id=' + @Model.idfMonitoringSession, ' ');" value="..." />                              
                                }
                                else
                                {
                                    <input class="coloredButton" type="button" value="..." />
                                }
                            </td>
                        </tr>
                    </table>                    
                </td>
                <td class="small">
                    @Html.LabelFor(m => m.strCampaignID)
                </td>
                <td class="xlarge">
                    @Html.BvEditbox(Model, "strCampaignID")
                </td>
            </tr>
            <tr>
                <td class="small">
                    @Html.LabelFor(m => m.SessionStatus)
                </td>
                <td>
                    @Html.BvEditbox(Model, "SessionStatus")
                </td>
                <td>
                    @Html.LabelFor(m => m.strCampaignName)
                </td>
                <td>
                    @Html.BvEditbox(Model, "strCampaignName")
                </td>
            </tr>                    
            <tr>
                <td>
                </td>
                <td>
                </td>
                <td>
                    @Html.LabelFor(m => m.CampaignType)
                </td>
                <td>
                    @Html.BvEditbox(Model, "CampaignType")
                </td>
            </tr>
        </table> 
        <table class="bordered">
            <tr>
                <td class="sectionName">      
                    @Translator.GetMessageString("titleSampleReceivingRegistration") 
                </td>
            </tr>
        </table>

        @Html.LabSampleReceiveGrid(Model.ID, Model.ObjectIdent + "Samples", Model.Samples, Model.IsReadOnly("Samples") || (Model.GetPermissions() == null ? false : Model.GetPermissions().IsReadOnlyForEdit), (int)eidss.model.Enums.HACode.None)

        <table class="bordered">
            <tr>
                <td class="sectionName">      
                    @Html.LabelFor(m => m.strSampleNotes)
                </td>
            </tr>
            <tr>
                <td>
                    @Html.BvTextArea(Model, "strSampleNotes")
                </td>
            </tr>
        </table>
    </div>          
}


